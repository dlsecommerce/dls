module.exports=[73590,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(46271),e=a.i(17545),f=a.i(81422),g=a.i(70179),h=a.i(70362),i=a.i(74167),j=a.i(49447);let k=({text:a})=>(0,b.jsxs)("div",{className:"relative group flex items-center",children:[(0,b.jsx)(j.HelpCircle,{className:"w-4 h-4 text-neutral-400 cursor-pointer"}),(0,b.jsx)("div",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-neutral-400/70 text-xs whitespace-nowrap font-normal opacity-0 group-hover:opacity-100 transition pointer-events-none z-20",children:a})]});var l=a.i(70430),m=a.i(66718),n=a.i(94202);let o=({isActive:a,sugestoes:c,listaRef:d,indiceSelecionado:e,onSelect:f})=>a&&c.length?(0,b.jsx)("div",{ref:d,className:"absolute z-50 mt-1 bg-[#0f0f0f] border border-white/10 rounded-md shadow-lg w-full max-h-40 overflow-y-auto",children:c.map((a,c)=>(0,b.jsxs)("div",{className:`px-2 py-1 text-xs text-white cursor-pointer flex justify-between ${c===e?"bg-[#1a8ceb]/30":"hover:bg-[#1a8ceb]/20"}`,onClick:()=>f(a.codigo,a.custo),children:[(0,b.jsx)("span",{children:a.codigo}),(0,b.jsxs)("span",{className:"text-[#1a8ceb]",children:["R$ ",a.custo.toFixed(2)]})]},c))}):null,p=({item:a,idx:c,composicao:d,setComposicao:e,removerItem:f,campoAtivo:g,sugestoes:h,indiceSelecionado:i,listaRef:j,buscarSugestoesDebounced:k,handleSugestoesKeys:p,selecionarSugestao:q,inputRefs:r,handleGridNav:s,isEditing:t,setEditing:u,toDisplay:v,toInternal:w,setSugestoes:x,setCampoAtivo:y})=>(0,b.jsxs)("div",{className:"relative grid grid-cols-3 gap-2 mb-1 p-1.5 rounded-lg bg-black/30 border border-white/10",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(l.Label,{className:"text-neutral-400 text-[10px] block mb-1",children:"Código"}),(0,b.jsx)(m.Input,{ref:a=>{r.current[c]||(r.current[c]=[]),r.current[c][0]=a},type:"text",placeholder:"SKU",value:a.codigo,onChange:a=>{let b=a.target.value,f=[...d];if(f[c].codigo=b,e(f),""===b.trim()){k.cancel?.(),x?.([]),y?.(null);return}k(b,c),y?.(c)},onKeyDown:a=>{p(a,c),s(a,c,0)},className:"bg-black/50 border-white/10 text-white text-xs rounded-md focus:border-[#1a8ceb] focus:ring-2 focus:ring-[#1a8ceb]"}),(0,b.jsx)(o,{isActive:g===c,sugestoes:h,listaRef:j,indiceSelecionado:i,onSelect:(a,b)=>q(a,b,c)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{className:"text-neutral-400 text-[10px] block mb-1",children:"Quantidade"}),(0,b.jsx)(m.Input,{ref:a=>{r.current[c]||(r.current[c]=[]),r.current[c][1]=a},type:"text",placeholder:"1",value:t(`q-${c}`)?a.quantidade:v(a.quantidade),onFocus:()=>u(`q-${c}`,!0),onBlur:a=>{u(`q-${c}`,!1);let b=[...d];b[c].quantidade=w(a.target.value),e(b)},onChange:a=>{let b=[...d];b[c].quantidade=w(a.target.value),e(b)},onKeyDown:a=>s(a,c,1),className:"bg-black/50 border-white/10 text-white text-xs rounded-md focus:border-[#1a8ceb]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{className:"text-neutral-400 text-[10px] block mb-1",children:"Custo (R$)"}),(0,b.jsx)(m.Input,{ref:a=>{r.current[c]||(r.current[c]=[]),r.current[c][2]=a},type:"text",placeholder:"100",value:t(`c-${c}`)?a.custo:v(a.custo),onFocus:()=>u(`c-${c}`,!0),onBlur:a=>{u(`c-${c}`,!1);let b=[...d];b[c].custo=w(a.target.value),e(b)},onChange:a=>{let b=[...d];b[c].custo=w(a.target.value),e(b)},onKeyDown:a=>s(a,c,2),className:"bg-black/50 border-white/10 text-white text-xs rounded-md focus:border-[#1a8ceb]"})]}),c>=1&&(0,b.jsx)(n.Button,{onClick:()=>f(c),size:"sm",variant:"ghost",className:"absolute top-0 right-0 translate-x-1/2 -translate-y-1/2   w-5 h-5 p-0 flex items-center justify-center    bg-red-500/20 hover:bg-red-500/40 text-red-400    border border-red-500/30 rounded-full shadow-sm    transition-all cursor-pointer",title:"Remover linha",children:"×"})]});var q=a.i(15618);let r=({onClick:a})=>(0,b.jsxs)(n.Button,{onClick:a,variant:"outline",className:"w-full border-white/10 text-white text-xs hover:bg-white/5 hover:border-[#1a8ceb]/50 rounded-xl transition-all mt-2",children:[(0,b.jsx)(q.Plus,{className:"w-3 h-3 mr-2"})," Incluir Custos"]});var s=a.i(21520),t=a.i(1299),u=a.i(5623);let v=({value:a})=>{let e=(0,s.useMotionValue)(0),f=(0,t.useTransform)(e,a=>a.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}));return(0,c.useEffect)(()=>(0,u.animate)(e,a,{duration:1,ease:"easeInOut"}).stop,[a,e]),(0,b.jsx)(d.motion.span,{children:f})},w=({custoTotal:a})=>(0,b.jsx)("div",{className:"mt-3 p-3 bg-gradient-to-br from-[#1a8ceb]/20 to-[#1a8ceb]/5 rounded-xl border border-[#1a8ceb]/30",children:(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,b.jsx)("span",{className:"text-neutral-300 text-xs mb-1",children:"Custo Total"}),(0,b.jsxs)("span",{className:"text-xl font-bold text-white",children:["R$ ",(0,b.jsx)(v,{value:Number(a)})]})]})}),x=({composicao:a,setComposicao:c,custoTotal:d,adicionarItem:e,removerItem:f,sugestoes:g,campoAtivo:h,indiceSelecionado:i,listaRef:j,buscarSugestoesDebounced:k,handleSugestoesKeys:l,selecionarSugestao:m,inputRefs:n,handleGridNav:o,isEditing:q,setEditing:s,toDisplay:t,toInternal:u})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:`space-y-1.5 ${a.length>10?"max-h-[360px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-[#1a8ceb]/30 scrollbar-track-transparent":""}`,children:a.map((d,e)=>(0,b.jsx)(p,{item:d,idx:e,composicao:a,setComposicao:c,removerItem:f,campoAtivo:h,sugestoes:g,indiceSelecionado:i,listaRef:j,buscarSugestoesDebounced:k,handleSugestoesKeys:l,selecionarSugestao:m,inputRefs:n,handleGridNav:o,isEditing:q,setEditing:s,toDisplay:t,toInternal:u},e))}),(0,b.jsx)(r,{onClick:e}),(0,b.jsx)(w,{custoTotal:d})]});var y=a.i(24669),z=a.i(84505),A=a.i(81560);let B=({handleDownload:a,handleClearAll:c,isClearing:e,clicks:f})=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.motion.button,{whileTap:{scale:.9},onClick:a,title:"Baixar planilha Excel",className:"p-2 hover:bg-white/10 rounded-full transition-all",children:(0,b.jsx)(z.Download,{className:"w-4 h-4 text-white opacity-70 hover:opacity-100"})}),(0,b.jsx)(d.motion.button,{whileTap:{scale:.9,rotate:-15},onClick:c,disabled:e&&f>=5,title:f>=5?"Botão bloqueado temporariamente após muitos cliques":"Limpar todos os dados",className:`p-2 rounded-full transition-all ${e?"bg-red-500/20 text-red-300 cursor-not-allowed":"hover:bg-red-500/10 text-red-400 hover:text-red-500"}`,children:(0,b.jsx)(A.Trash2,{className:`w-4 h-4 transition-transform ${e?"animate-pulse":""}`})})]}),C=({nome:a,blocoIndex:c,state:d,setState:e,preco:f,refs:g,isEditing:h,setEditing:i,toDisplay:j,toInternal:k,handleLinearNav:n,handleEmbalagemBlur:o,handleEmbalagemChange:p,onFieldChange:q,onFieldBlur:r})=>{let s=["desconto","frete","imposto","comissao","margem","marketing"];return(0,b.jsxs)("div",{className:"p-2 rounded-lg bg-black/30 border border-white/10 flex flex-col justify-center items-center",children:[(0,b.jsx)("h4",{className:"text-white font-semibold text-xs mb-1 text-center",children:a}),s.map((a,f)=>(0,b.jsxs)("div",{className:"mb-1 w-full",children:[(0,b.jsx)(l.Label,{className:"text-neutral-400 text-[10px] block",children:"margem"===a?"Margem de Lucro (%)":"frete"===a?"Frete (R$)":a.charAt(0).toUpperCase()+a.slice(1)+" (%)"}),(0,b.jsx)(m.Input,{ref:a=>g.current[f]=a,type:"text",value:h(`${c}-${a}`)?d[a]:j(d[a]),onFocus:()=>i(`${c}-${a}`,!0),onBlur:b=>{let f;i(`${c}-${a}`,!1),f=k(b.target.value),r?r(a,f):e({...d,[a]:f})},onChange:b=>{let c;return c=k(b.target.value),void(q?q(a,c):e({...d,[a]:c}))},onKeyDown:a=>n(a,f,g,s.length),className:"bg-black/50 border border-white/10 text-white text-[11px] rounded-md focus:border-[#1a8ceb] focus:ring-2 focus:ring-[#1a8ceb]"}),"desconto"===a&&(0,b.jsxs)("div",{className:"mt-1",children:[(0,b.jsx)(l.Label,{className:"text-neutral-400 text-[10px] block",children:"Embalagem (R$)"}),(0,b.jsx)(m.Input,{type:"text",value:h(`emb-${c}`)?d.embalagem??"":j(d.embalagem??""),onFocus:()=>i(`emb-${c}`,!0),onBlur:a=>{i(`emb-${c}`,!1),o(a.target.value)},onChange:a=>{p(a.target.value)},className:"bg-black/50 border border-white/10 text-white text-[11px] rounded-md focus:border-[#1a8ceb] focus:ring-2 focus:ring-[#1a8ceb]"})]})]},a)),(0,b.jsxs)("div",{className:"mt-1 text-center flex flex-col items-center justify-center py-1",children:[(0,b.jsx)("span",{className:"text-neutral-300 text-[10px]",children:"Preço de Venda"}),(0,b.jsxs)("div",{className:"text-lg font-bold text-[#1a8ceb] leading-tight",children:["R$ ",(0,b.jsx)(v,{value:f})]})]})]})},D=(0,a.i(70106).default)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),E=({acrescimos:a,setAcrescimos:c,isEditing:d,setEditing:e,toDisplay:f,toInternal:g,handleLinearNav:h,acrescimosRefs:i})=>(0,b.jsxs)("div",{className:"p-3 rounded-lg bg-black/30 border border-white/10",children:[(0,b.jsxs)("h4",{className:"font-bold text-white text-xs mb-2 flex items-center gap-2",children:[(0,b.jsx)(D,{className:"w-4 h-4 text-[#1a8ceb]"}),"Cálculo de Acréscimos",(0,b.jsx)(k,{text:"Calculo de Acréscimo."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,b.jsx)("div",{className:"flex flex-col gap-2",children:(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{className:"text-neutral-400 text-[10px] mb-1 block",children:"Preço Loja (R$)"}),(0,b.jsx)(m.Input,{ref:a=>i.current[0]=a,type:"text",value:d("a-precoLoja")?a.precoLoja:f(a.precoLoja),onFocus:()=>e("a-precoLoja",!0),onBlur:b=>{e("a-precoLoja",!1),c({...a,precoLoja:g(b.target.value)})},onChange:b=>c({...a,precoLoja:g(b.target.value)}),onKeyDown:a=>h(a,0,i,5),className:"bg-black/50 border border-white/10 text-white text-xs rounded-md focus:border-[#1a8ceb] focus:ring-2 focus:ring-[#1a8ceb]"})]})}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{className:"text-neutral-400 text-[10px] mb-1 block",children:"Preço Mercado Livre Clássico (R$)"}),(0,b.jsx)(m.Input,{ref:a=>i.current[1]=a,type:"text",value:d("a-precoMLClassico")?a.precoMercadoLivreClassico:f(a.precoMercadoLivreClassico),onFocus:()=>e("a-precoMLClassico",!0),onBlur:b=>{e("a-precoMLClassico",!1),c({...a,precoMercadoLivreClassico:g(b.target.value)})},onChange:b=>c({...a,precoMercadoLivreClassico:g(b.target.value)}),onKeyDown:a=>h(a,1,i,5),className:"bg-black/50 border border-white/10 text-white text-xs rounded-md focus:border-[#1a8ceb] focus:ring-2 focus:ring-[#1a8ceb]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{className:"text-neutral-400 text-[10px] mb-1 block",children:"Preço Mercado Livre Premium (R$)"}),(0,b.jsx)(m.Input,{ref:a=>i.current[2]=a,type:"text",value:d("a-precoMLPremium")?a.precoMercadoLivrePremium:f(a.precoMercadoLivrePremium),onFocus:()=>e("a-precoMLPremium",!0),onBlur:b=>{e("a-precoMLPremium",!1),c({...a,precoMercadoLivrePremium:g(b.target.value)})},onChange:b=>c({...a,precoMercadoLivrePremium:g(b.target.value)}),onKeyDown:a=>h(a,2,i,5),className:"bg-black/50 border border-white/10 text-white text-xs rounded-md focus:border-[#1a8ceb] focus:ring-2 focus:ring-[#1a8ceb]"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{className:"text-neutral-400 text-[10px] mb-1 block",children:"Frete Clássico (R$)"}),(0,b.jsx)(m.Input,{ref:a=>i.current[3]=a,type:"text",value:d("a-freteClassico")?a.freteMercadoLivreClassico:f(a.freteMercadoLivreClassico),onFocus:()=>e("a-freteClassico",!0),onBlur:b=>{e("a-freteClassico",!1),c({...a,freteMercadoLivreClassico:g(b.target.value)})},onChange:b=>c({...a,freteMercadoLivreClassico:g(b.target.value)}),onKeyDown:a=>h(a,3,i,5),className:"bg-black/50 border border-white/10 text-white text-xs rounded-md focus:border-[#1a8ceb] focus:ring-2 focus:ring-[#1a8ceb]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{className:"text-neutral-400 text-[10px] mb-1 block",children:"Frete Premium (R$)"}),(0,b.jsx)(m.Input,{ref:a=>i.current[4]=a,type:"text",value:d("a-fretePremium")?a.freteMercadoLivrePremium:f(a.freteMercadoLivrePremium),onFocus:()=>e("a-fretePremium",!0),onBlur:b=>{e("a-fretePremium",!1),c({...a,freteMercadoLivrePremium:g(b.target.value)})},onChange:b=>c({...a,freteMercadoLivrePremium:g(b.target.value)}),onKeyDown:a=>h(a,4,i,5),className:"bg-black/50 border border-white/10 text-white text-xs rounded-md focus:border-[#1a8ceb] focus:ring-2 focus:ring-[#1a8ceb]"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mt-2",children:[(0,b.jsxs)("div",{className:`flex flex-col justify-center items-center text-[11px] rounded-md p-3 transition-all duration-300 ${a.acrescimoClassico>0?"bg-green-500/10 border border-green-500/30":a.acrescimoClassico<0?"bg-red-500/10 border border-red-500/30":"bg-white/5 border border-white/10"}`,children:[(0,b.jsx)("span",{className:"text-neutral-300 mb-1",children:"Acréscimo Clássico"}),(0,b.jsxs)("span",{className:`font-semibold text-base ${a.acrescimoClassico>0?"text-green-400":a.acrescimoClassico<0?"text-red-400":"text-neutral-400"}`,children:[(0,b.jsx)(v,{value:Number(a.acrescimoClassico||0)}),"%"]})]}),(0,b.jsxs)("div",{className:`flex flex-col justify-center items-center text-[11px] rounded-md p-3 transition-all duration-300 ${a.acrescimoPremium>0?"bg-green-500/10 border border-green-500/30":a.acrescimoPremium<0?"bg-red-500/10 border border-red-500/30":"bg-white/5 border border-white/10"}`,children:[(0,b.jsx)("span",{className:"text-neutral-300 mb-1",children:"Acréscimo Premium"}),(0,b.jsxs)("span",{className:`font-semibold text-base ${a.acrescimoPremium>0?"text-green-400":a.acrescimoPremium<0?"text-red-400":"text-neutral-400"}`,children:[(0,b.jsx)(v,{value:Number(a.acrescimoPremium||0)}),"%"]})]})]})]})]})]}),F=({calculoLoja:a,setCalculoLoja:c,calculoShopee:e,setCalculoShopee:f,calculoMLClassico:g,setCalculoMLClassico:h,calculoMLPremium:i,setCalculoMLPremium:j,precoLoja:l,precoShopee:m,precoMLClassico:n,precoMLPremium:o,acrescimos:p,setAcrescimos:q,isEditing:r,setEditing:s,toDisplay:t,toInternal:u,handleLinearNav:v,calcLojaRefs:w,calcShopeeRefs:x,calcMLClassicoRefs:z,calcMLPremiumRefs:A,acrescimosRefs:D,handleEmbalagemBlurShared:F,handleEmbalagemChangeShared:G,handleEmbalagemBlurShopee:H,handleEmbalagemChangeShopee:I,handleDownload:J,handleClearAll:K,isClearing:L,clicks:M,statusAcrescimo:N,syncDescontoFromLoja:O,userEditedShopeeComissao:P,setUserEditedShopeeComissao:Q,userEditedShopeeFrete:R,setUserEditedShopeeFrete:S})=>(0,b.jsx)(d.motion.div,{className:"lg:col-span-6 p-2 rounded-xl bg-white/5 border border-white/10 backdrop-blur-lg shadow-lg flex flex-col justify-between h-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(y.TrendingUp,{className:"w-5 h-5 text-[#1a8ceb]"}),(0,b.jsxs)("h3",{className:"text-base font-bold text-white flex items-center gap-2",children:["Cálculo de Preço",(0,b.jsx)(k,{text:"Preços de Venda."})]})]}),(0,b.jsx)(B,{handleDownload:J,handleClearAll:K,isClearing:L,clicks:M})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2 mb-2",children:[(0,b.jsx)(C,{nome:"Preço Loja",blocoIndex:0,state:a,setState:c,preco:l,refs:w,isEditing:r,setEditing:s,toDisplay:t,toInternal:u,handleLinearNav:v,handleEmbalagemBlur:F,handleEmbalagemChange:G,onFieldChange:(b,d)=>{"desconto"===b?O(d):c({...a,[b]:d})},onFieldBlur:(b,d)=>{"desconto"===b?O(d):c({...a,[b]:d})}}),(0,b.jsx)(C,{nome:"Preço Shopee",blocoIndex:1,state:e,setState:f,preco:m,refs:x,isEditing:r,setEditing:s,toDisplay:t,toInternal:u,handleLinearNav:v,handleEmbalagemBlur:H,handleEmbalagemChange:I,onFieldChange:(a,b)=>{"comissao"===a&&Q(!0),"frete"===a&&S(!0),f({...e,[a]:b})},onFieldBlur:(a,b)=>{"comissao"!==a||b||Q(!1),"frete"!==a||b||S(!1),f({...e,[a]:b})}}),(0,b.jsx)(C,{nome:"Preço ML Clássico",blocoIndex:2,state:g,setState:h,preco:n,refs:z,isEditing:r,setEditing:s,toDisplay:t,toInternal:u,handleLinearNav:v,handleEmbalagemBlur:F,handleEmbalagemChange:G}),(0,b.jsx)(C,{nome:"Preço ML Premium",blocoIndex:3,state:i,setState:j,preco:o,refs:A,isEditing:r,setEditing:s,toDisplay:t,toInternal:u,handleLinearNav:v,handleEmbalagemBlur:F,handleEmbalagemChange:G})]}),(0,b.jsx)(E,{acrescimos:p,setAcrescimos:q,isEditing:r,setEditing:s,toDisplay:t,toInternal:u,handleLinearNav:v,acrescimosRefs:D,statusAcrescimo:N})]})}),G=a=>{if(!a)return"";let b=a.replace(/\s+/g,"");b.includes(",")&&(b=b.replace(/\./g,"").replace(",","."));let c=(b=b.replace(/[^\d.-]/g,"")).split(".");return c.length>2&&(b=c.shift()+"."+c.join("")),b},H=a=>{if(!a)return"";let b=Number(a);return isFinite(b)?b.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):a};function I(){let a,{composicao:j,setComposicao:l,acrescimos:m,setAcrescimos:n,custoTotal:o,statusAcrescimo:p,adicionarItem:q,removerItem:r}=(0,f.usePrecificacao)(),[s,t]=(0,c.useState)({desconto:"",imposto:"12",margem:"15",frete:"",comissao:"6",marketing:"2",embalagem:"2.5"}),[u,v]=(0,c.useState)({desconto:"",imposto:"12",margem:"15",frete:"",comissao:"20",marketing:"2",embalagem:"6.5"}),[w,y]=(0,c.useState)({desconto:"",imposto:"12",margem:"15",frete:"",comissao:"11",marketing:"2",embalagem:"2.5"}),[z,A]=(0,c.useState)({desconto:"",imposto:"12",margem:"15",frete:"",comissao:"16",marketing:"2",embalagem:"2.5"}),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[I,J]=(0,c.useState)([]),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(-1),O=(0,c.useRef)(null),P=(0,c.useRef)([]),Q=(0,c.useRef)([]),R=(0,c.useRef)([]),S=(0,c.useRef)([]),T=(0,c.useRef)([]),U=(0,c.useRef)([]),[V,W]=(0,c.useState)(new Set),X=(a,b)=>{W(c=>{let d=new Set(c);return b?d.add(a):d.delete(a),d})},Y=a=>V.has(a);(0,c.useEffect)(()=>{let a=a=>{if(null===K)return;let b=O.current,c=P.current[K]?.[0],d=a.target,e=!!(b&&b.contains(d)),f=!!(c&&c.contains(d));if(!e&&!f){if(I.length>0){let a=I[0];aa(K,a.codigo,a.custo)}J([]),L(null),N(-1),c?.blur()}};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[K,I]),(0,c.useEffect)(()=>{if(O.current&&M>=0){let a=O.current.children[M];a&&a.scrollIntoView({block:"nearest"})}},[M]);let Z="",$=async(a,b)=>{let c=a.trim();if(Z=c,!c)return void J([]);let d=await i.supabase.from("custos").select('"Código", "Custo Atual"').eq('"Código"',c).limit(5);if(Z!==c)return;if(d.data&&d.data.length>0){L(b),J(d.data.map(a=>({codigo:a["Código"],custo:Number(a["Custo Atual"])||0}))),N(0);return}let e=await i.supabase.from("custos").select('"Código", "Custo Atual"').ilike('"Código"',`${c}%`).limit(5);if(Z!==c)return;if(e.data&&e.data.length>0){L(b),J(e.data.map(a=>({codigo:a["Código"],custo:Number(a["Custo Atual"])||0}))),N(0);return}let f=await i.supabase.from("custos").select('"Código", "Custo Atual"').ilike('"Código"',`%${c}%`).limit(5);Z===c&&(L(b),J(f.data?.map(a=>({codigo:a["Código"],custo:Number(a["Custo Atual"])||0}))||[]),N(0))},_=(0,c.useRef)((...b)=>{clearTimeout(a),a=setTimeout(()=>$(...b),120)}).current,aa=(a,b,c)=>{let d=[...j];d[a].codigo=b,d[a].custo=(Number(c)||0).toFixed(2),l(d)},ab=(a,b,c)=>{aa(c,a,b),J([]),L(null),N(-1),setTimeout(()=>{P.current[c]?.[0]?.focus()},50)},ac=a=>{let b=j.reduce((a,b)=>a+(parseFloat(b.custo)||0)*(parseFloat(b.quantidade)||0),0),c=(parseFloat(a.desconto)||0)/100,d=(parseFloat(a.imposto)||0)/100,e=(parseFloat(a.margem)||0)/100,f=(parseFloat(a.comissao)||0)/100,g=(parseFloat(a.marketing)||0)/100,h=parseFloat(a.frete)||0,i=parseFloat(a.embalagem||"2.5")||0,k=1-(d+e+f+g),l=k>0?(b*(1-c)+h+i)/k:0;return isFinite(l)?l:0},ad=ac(s),ae=ac(u),af=ac(w),ag=ac(z);(0,c.useEffect)(()=>{let a=ae>500?"0":"20",b=ae>500?"100":"0";v(c=>{let d=B?c.comissao:a,e=D?c.frete:b;return d===c.comissao&&e===c.frete?c:{...c,comissao:d,frete:e}})},[ae,B,D]),(0,c.useEffect)(()=>{n(a=>({...a,precoLoja:ad.toFixed(2),precoMercadoLivreClassico:af.toFixed(2),precoMercadoLivrePremium:ag.toFixed(2),freteMercadoLivreClassico:w.frete||"0",freteMercadoLivrePremium:z.frete||"0"}))},[ad,af,ag,w.frete,z.frete]);let[ah,ai]=(0,c.useState)(!1),[aj,ak]=(0,c.useState)(0);return(0,c.useEffect)(()=>{if(0===aj)return;let a=setTimeout(()=>ak(0),5e3);return()=>clearTimeout(a)},[aj]),(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[#0a0a0a] via-[#0f0f0f] to-[#0a0a0a] p-4 md:p-8 pt-24",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4",children:[(0,b.jsxs)(d.motion.div,{className:"lg:col-span-6 p-2 rounded-xl bg-white/5 border border-white/10 backdrop-blur-lg shadow-lg h-full relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(e.Layers,{className:"w-5 h-5 text-[#1a8ceb]"}),(0,b.jsxs)("h3",{className:"text-base font-bold text-white flex items-center gap-2",children:["Composição",(0,b.jsx)(k,{text:"Composição de Custos."})]})]}),(0,b.jsx)(x,{composicao:j,setComposicao:l,custoTotal:o,adicionarItem:q,removerItem:r,sugestoes:I,campoAtivo:K,indiceSelecionado:M,listaRef:O,inputRefs:P,buscarSugestoesDebounced:_,handleSugestoesKeys:(a,b)=>{if(I.length)if("ArrowDown"===a.key)a.preventDefault(),N(a=>a<I.length-1?a+1:0);else if("ArrowUp"===a.key)a.preventDefault(),N(a=>a>0?a-1:I.length-1);else if("Enter"===a.key){a.preventDefault();let c=I[M>=0?M:0];ab(c.codigo,c.custo,b)}else if("Tab"===a.key){a.preventDefault();let c=M>=0?M:0;aa(b,I[c].codigo,I[c].custo),J([]),L(null),N(-1)}else"Escape"===a.key&&(a.preventDefault(),J([]),L(null),N(-1))},handleGridNav:(a,b,c)=>{if(I.length&&K===b)return;let d=j.length;"ArrowDown"===a.key||"Enter"===a.key?(a.preventDefault(),P.current[b+1<d?b+1:0]?.[c]?.focus()):"ArrowUp"===a.key&&(a.preventDefault(),P.current[b-1>=0?b-1:d-1]?.[c]?.focus())},selecionarSugestao:ab,confirmarSugestaoPrimeira:aa,isEditing:Y,setEditing:X,toDisplay:H,toInternal:G})]}),(0,b.jsx)(F,{calculoLoja:s,setCalculoLoja:t,calculoShopee:u,setCalculoShopee:v,calculoMLClassico:w,setCalculoMLClassico:y,calculoMLPremium:z,setCalculoMLPremium:A,precoLoja:ad,precoShopee:ae,precoMLClassico:af,precoMLPremium:ag,acrescimos:m,setAcrescimos:n,isEditing:Y,setEditing:X,toDisplay:H,toInternal:G,handleLinearNav:(a,b,c,d)=>{"ArrowDown"!==a.key&&"Enter"!==a.key&&("Tab"!==a.key||a.shiftKey)?("ArrowUp"===a.key||"Tab"===a.key&&a.shiftKey)&&(a.preventDefault(),c.current[(b-1+d)%d]?.focus()):(a.preventDefault(),c.current[(b+1)%d]?.focus())},calcLojaRefs:Q,calcShopeeRefs:R,calcMLClassicoRefs:S,calcMLPremiumRefs:T,acrescimosRefs:U,handleEmbalagemBlurShared:a=>{let b=G(a||"2.5")||"2.5";t(a=>({...a,embalagem:b})),y(a=>({...a,embalagem:b})),A(a=>({...a,embalagem:b}))},handleEmbalagemChangeShared:a=>{let b=G(a);t(a=>({...a,embalagem:b})),y(a=>({...a,embalagem:b})),A(a=>({...a,embalagem:b}))},handleEmbalagemBlurShopee:a=>{let b=G(a||"6.5")||"6.5";v(a=>({...a,embalagem:b}))},handleEmbalagemChangeShopee:a=>{let b=G(a);v(a=>({...a,embalagem:b}))},handleDownload:()=>{let a=new Date,b=a.toLocaleDateString("pt-BR").replace(/\//g,"-"),c=`${a.getHours().toString().padStart(2,"0")}h${a.getMinutes().toString().padStart(2,"0")}m`,d=`PRECIFICACAO_${b}_${c}.xlsx`,e=[["Composição de Custos"],["Gerado em",a.toLocaleString("pt-BR")],[],["Código","Quantidade","Custo (R$)"],...j.map(a=>[a.codigo||"",a.quantidade||"",a.custo||""])],f=h.utils.aoa_to_sheet(e),i=[["Resumo de Precificação"],["Gerado em",a.toLocaleString("pt-BR")],[],["Custo Total (R$)",o],["Preço Loja (R$)",ad],["Preço Shopee (R$)",ae],["Preço ML Clássico (R$)",af],["Preço ML Premium (R$)",ag],[],["Regras Loja"],...Object.entries(s),[],["Regras Shopee"],...Object.entries(u),[],["Regras Mercado Livre Clássico"],...Object.entries(w),[],["Regras Mercado Livre Premium"],...Object.entries(z)],k=h.utils.aoa_to_sheet(i),l={fill:{type:"pattern",patternType:"solid",fgColor:{rgb:"1A8CEB"}},font:{bold:!0,color:{rgb:"FFFFFF"},sz:11},border:{top:{style:"thin",color:{rgb:"FFFFFF"}},bottom:{style:"thin",color:{rgb:"FFFFFF"}},left:{style:"thin",color:{rgb:"FFFFFF"}},right:{style:"thin",color:{rgb:"FFFFFF"}}},alignment:{horizontal:"center",vertical:"center"}},m=(a,b,c)=>{let d="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");for(let e=0;e<c;e++){let c=`${d[e]}${b}`;a[c]&&(a[c].s=l)}};m(f,4,3),m(k,1,1),f["!cols"]=[{wch:24},{wch:16},{wch:16}],k["!cols"]=[{wch:32},{wch:22}];let n=h.utils.book_new();h.utils.book_append_sheet(n,f,"Composição"),h.utils.book_append_sheet(n,k,"Resumo");let p=new Blob([h.write(n,{bookType:"xlsx",type:"array",cellStyles:!0})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,g.saveAs)(p,d)},handleClearAll:()=>{ak(a=>{let b=a+1;return b<5?(ai(!0),l([]),t({desconto:"",imposto:"12",margem:"15",frete:"",comissao:"6",marketing:"2",embalagem:"2.5"}),v({desconto:"",imposto:"12",margem:"15",frete:"",comissao:"20",marketing:"2",embalagem:"6.5"}),y({desconto:"",imposto:"12",margem:"15",frete:"",comissao:"11",marketing:"2",embalagem:"2.5"}),A({desconto:"",imposto:"12",margem:"15",frete:"",comissao:"16",marketing:"2",embalagem:"2.5"}),n({precoLoja:"",precoMercadoLivreClassico:"",precoMercadoLivrePremium:"",freteMercadoLivreClassico:"",freteMercadoLivrePremium:"",acrescimoClassico:0,acrescimoPremium:0}),C(!1),E(!1),setTimeout(()=>ai(!1),300)):(ai(!0),console.warn("Botão de limpar bloqueado após 5 cliques.")),b})},isClearing:ah,clicks:aj,statusAcrescimo:p,syncDescontoFromLoja:a=>{t(b=>({...b,desconto:a})),v(b=>({...b,desconto:a})),y(b=>({...b,desconto:a})),A(b=>({...b,desconto:a}))},userEditedShopeeComissao:B,setUserEditedShopeeComissao:C,userEditedShopeeFrete:D,setUserEditedShopeeFrete:E})]})})}function J(){return(0,b.jsx)(I,{})}a.s(["default",()=>J],73590)}];

//# sourceMappingURL=src_app_dashboard_precificacao_precificacao-individual_page_tsx_942795ad._.js.map