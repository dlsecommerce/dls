module.exports=[74150,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(46271),e=a.i(94202),f=a.i(91557),g=a.i(73320),h=a.i(67453),i=a.i(24722),j=a.i(33508),k=a.i(68114);let l=({label:a,onFileSelect:d,selectedFile:l,stepNumber:m,icon:n})=>{let[o,p]=(0,c.useState)(!1),q=(0,c.useRef)(null);return(0,b.jsxs)(f.GlassmorphicCard,{className:(0,k.cn)("relative w-full h-full overflow-hidden cursor-pointer transition-all duration-300 group",l?"bg-blue-500/10 border-none ring-1 ring-blue-500/40 shadow-[0_0_15px_rgba(30,144,255,0.3)]":o?"border-2 border-blue-400 bg-blue-400/10 animate-pulse":"border-2 border-border hover:border-blue-400/50 hover:shadow-lg hover:scale-[1.02]"),onClick:()=>q.current?.click(),onDragOver:a=>{a.preventDefault(),p(!0)},onDragLeave:()=>p(!1),onDrop:a=>{a.preventDefault(),p(!1);let b=a.dataTransfer.files?.[0]||null;b&&d(b)},children:[(0,b.jsx)("div",{className:(0,k.cn)("absolute top-3 left-3 w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold text-white shadow-md transition-all duration-300 z-10",l?"bg-blue-500":"bg-blue-400"),children:m}),l&&(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 w-7 h-7 opacity-0 group-hover:opacity-100 transition-opacity z-10 hover:bg-red-500 hover:text-white",onClick:a=>{a.stopPropagation(),d(null),q.current&&(q.current.value="")},children:(0,b.jsx)(j.X,{className:"w-4 h-4"})}),(0,b.jsx)("input",{ref:q,type:"file",accept:".xlsx,.xls,.csv",onChange:a=>{let b=a.target.files?.[0]||null;b&&d(b)},className:"hidden"}),(0,b.jsxs)("div",{className:"p-6 flex flex-col items-center justify-center min-h-[200px] space-y-3",children:[(0,b.jsx)("div",{className:(0,k.cn)("rounded-full p-4 transition-all duration-300",l?"bg-blue-500 text-white scale-110":"bg-blue-500/10 text-blue-400"),children:l?(0,b.jsx)(h.CheckCircle2,{className:"w-8 h-8"}):n||(0,b.jsx)(i.FileSpreadsheet,{className:"w-8 h-8"})}),(0,b.jsxs)("div",{className:"text-center space-y-1 w-full px-2",children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:a}),l?(0,b.jsx)("p",{className:"text-xs text-blue-500 font-medium truncate max-w-full",children:l.name}):(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Clique ou arraste o arquivo"})]}),(0,b.jsx)(g.Upload,{className:(0,k.cn)("w-5 h-5 transition-all duration-300",l?"opacity-0 scale-0":"opacity-40 scale-100",o&&"scale-125 opacity-70")})]})]})};var m=a.i(62036);let n=({totalSteps:a,completedSteps:e,loading:f=!1})=>{let[g,h]=(0,c.useState)(0);(0,c.useEffect)(()=>{if(f){h(0);let a=setInterval(()=>{h(a=>{let b=a+12*Math.random();return b>=100?100:b})},300);return()=>clearInterval(a)}h(0)},[f]);let i=e>=a;return(0,b.jsx)("div",{className:"relative w-3/4 mx-auto h-4 mt-2 flex items-center justify-center",children:(0,b.jsx)(m.AnimatePresence,{mode:"wait",children:f?(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:4},transition:{duration:.25},className:"w-full h-2 rounded-full bg-neutral-800/40 overflow-hidden",children:(0,b.jsx)(d.motion.div,{animate:{width:`${g}%`},transition:{duration:.4,ease:"easeInOut"},className:"h-full bg-gradient-to-r bg-blue-500 rounded-full shadow-[0_0_10px_#3b82f6]"})},"loading"):(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:4},transition:{duration:.25},className:"flex justify-between gap-1 w-full",children:Array.from({length:a}).map((a,c)=>(0,b.jsx)("div",{className:(0,k.cn)("flex-1 h-1.5 rounded-full transition-all duration-500",i?"bg-green-500":c<e?"bg-blue-500":"bg-neutral-300")},c))},"steps")})})};var o=a.i(28193),p=a.i(83497),q=a.i(38784),r=a.i(70106);let s=(0,r.default)("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),t=(0,r.default)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),u=(0,r.default)("repeat-2",[["path",{d:"m2 9 3-3 3 3",key:"1ltn5i"}],["path",{d:"M13 18H7a2 2 0 0 1-2-2V6",key:"1r6tfw"}],["path",{d:"m22 15-3 3-3-3",key:"4rnwn2"}],["path",{d:"M11 6h6a2 2 0 0 1 2 2v10",key:"2f72bc"}]]);var v=a.i(99209),w=a.i(69012);function x({selectedLoja:a,setSelectedLoja:e}){let[f,g]=(0,c.useState)(!1);return(0,b.jsxs)(v.Popover,{open:f,onOpenChange:g,children:[(0,b.jsx)(v.PopoverTrigger,{asChild:!0,children:(0,b.jsx)(d.motion.button,{whileTap:{scale:.9,rotate:-10},title:"Filtrar loja",className:`p-2 rounded-full transition-all hover:bg-white/10 
            ${"Pikot Shop"===a?"text-[#1A8CEB]":"SÃ³baquetas"===a?"text-[#f472b6]":"text-neutral-400 hover:text-white"}`,children:(0,b.jsx)(w.Filter,{className:"w-5 h-5 scale-[0.85]"})})}),(0,b.jsx)(v.PopoverPortal,{children:(0,b.jsxs)(v.PopoverContent,{style:{position:"fixed",zIndex:9999},className:"bg-[#0f0f0f]/80 backdrop-blur-xl border border-white/10 w-44 p-2 rounded-xl shadow-2xl",sideOffset:8,align:"end",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-white/90 mb-2 px-2",children:"Escolher loja"}),(0,b.jsx)("div",{className:"flex flex-col gap-1",children:["Pikot Shop","SÃ³baquetas"].map(c=>(0,b.jsx)("button",{onClick:()=>{e(c),g(!1)},className:`w-full text-left px-3 py-1.5 rounded-lg text-sm transition-all 
                  ${a===c?"bg-[#1A8CEB]/30 text-[#1A8CEB] border border-[#1A8CEB]/40":"text-neutral-300 hover:bg-white/10 hover:text-white"}`,children:c},c))})]})})]})}var y=a.i(14574),z=a.i(75750);function A({open:a,onOpenChange:f,file:g,onConfirm:h}){let[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(!1),[n,p]=(0,c.useState)("");return(0,c.useEffect)(()=>{if(g){m(!0);let a=new FileReader;a.onload=a=>{try{let b=a.target?.result,c=z.read(b,{type:"array"}),d=c.SheetNames[0],e=c.Sheets[d],f=z.utils.sheet_to_json(e,{header:1,defval:""});k(f.filter(a=>a.length>0).slice(0,6)),p(d)}catch(a){console.error("Erro ao ler planilha:",a),k([])}finally{m(!1)}},a.readAsArrayBuffer(g)}},[g]),(0,b.jsx)(y.Dialog,{open:a,onOpenChange:a=>!l&&f(a),children:(0,b.jsxs)(y.DialogContent,{className:"bg-[#0f0f0f]/95 backdrop-blur-xl border border-neutral-700 rounded-2xl text-white max-w-3xl shadow-2xl",children:[(0,b.jsx)(y.DialogHeader,{children:(0,b.jsxs)(y.DialogTitle,{className:"text-lg font-semibold text-white flex items-center gap-2",children:[(0,b.jsx)(i.FileSpreadsheet,{className:"w-5 h-5 text-emerald-400"}),"PrÃ©-visualizaÃ§Ã£o da Planilha"]})}),g&&(0,b.jsxs)("div",{className:"text-sm text-neutral-400 mb-3",children:[(0,b.jsx)("span",{className:"font-medium text-white",children:g.name})," â€”"," ",(g.size/1024).toFixed(1)," KB",n&&(0,b.jsxs)("span",{className:"ml-2 text-emerald-400",children:["(",n,")"]})]}),l?(0,b.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,b.jsx)(o.Loader,{className:"animate-spin w-6 h-6 text-neutral-400"})}):0===j.length?(0,b.jsx)("p",{className:"text-center text-neutral-400 py-6",children:"Nenhum dado encontrado nesta planilha."}):(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"overflow-x-auto max-h-[400px] rounded-lg border border-neutral-700",children:(0,b.jsx)("table",{className:"min-w-full border-collapse",children:(0,b.jsx)("tbody",{children:j.map((a,c)=>(0,b.jsx)("tr",{className:`${0===c?"bg-emerald-500/10 text-emerald-300 font-semibold":"text-neutral-300"} border-b border-neutral-700`,children:a.map((a,c)=>(0,b.jsx)("td",{className:"px-3 py-2 text-sm whitespace-nowrap",children:a??""},c))},c))})})}),(0,b.jsxs)(y.DialogFooter,{className:"mt-5 flex justify-end gap-3",children:[(0,b.jsx)(e.Button,{variant:"outline",className:"border-neutral-700 text-white hover:scale-105 transition-all cursor-pointer",onClick:()=>f(!1),disabled:l,children:"Cancelar"}),g&&(0,b.jsx)(e.Button,{className:"bg-gradient-to-r from-emerald-500 to-emerald-600 hover:scale-105 text-white flex items-center gap-2 cursor-pointer",onClick:()=>h(g),disabled:l,children:"Confirmar"})]})]})})}var B=a.i(70179);function C(){let{planilhas:a,handleFileSelect:e,iniciarAutomacao:g,status:i}=function(){let[a,b]=(0,c.useState)({modelo:null,vinculo:null,bling:null,tray:null}),[d,e]=(0,c.useState)("idle"),f=async()=>{if(a.modelo&&a.vinculo&&a.bling&&a.tray)try{e("uploading");let b=new FormData;b.append("modelo",a.modelo),b.append("bling",a.bling),b.append("tray",a.tray),b.append("vinculo",a.vinculo),e("processing");let c=await fetch("http://localhost:5000/atualizar-planilha",{method:"POST",body:b});if(!c.ok)throw Error("Erro ao processar as planilhas no servidor.");let d=await c.blob(),f=new Date().toLocaleString("pt-BR").replace(/[/,:\s]/g,"-"),g=`AUTOMA\xc7\xc3O - MODELO - ${f}.xlsx`;(0,B.saveAs)(d,g),e("done")}catch(a){console.error("Erro:",a),e("error")}};return{planilhas:a,handleFileSelect:(a,c)=>{b(b=>({...b,[a]:c}))},iniciarAutomacao:f,status:d}}(),[j,k]=(0,c.useState)("Pikot Shop"),[m,r]=(0,c.useState)("idle"),[v,w]=(0,c.useState)(!1),[y,z]=(0,c.useState)(null),[C,D]=(0,c.useState)(null),E=a.modelo&&a.vinculo&&a.bling&&a.tray,F=Object.values(a).filter(a=>null!==a).length;(0,c.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}),[]);let G=async()=>{if(!a.modelo||!a.vinculo||!a.bling||!a.tray)return void alert("âš ï¸ Selecione todas as planilhas: Bling, Tray, VÃ­nculo e Modelo.");try{r("processing"),console.log("ðŸš€ Iniciando automaÃ§Ã£o..."),await g(),r("success")}catch(a){console.error("Erro ao processar:",a),r("error")}finally{setTimeout(()=>r("idle"),4e3)}};return(0,b.jsxs)("div",{className:"min-h-screen w-full flex flex-col items-center justify-start bg-transparent overflow-hidden mt-20",children:[(0,b.jsx)("div",{className:"w-full max-w-[1400px] mx-auto flex justify-center",children:(0,b.jsxs)(f.GlassmorphicCard,{className:"relative w-full h-[70vh] flex flex-col justify-center items-center p-10 space-y-6 rounded-2xl shadow-2xl backdrop-blur-md border border-white/10 overflow-hidden",children:[(0,b.jsxs)("div",{className:"absolute top-6 right-6 flex items-center gap-3",children:[(0,b.jsx)(d.motion.button,{whileTap:{scale:.9,rotate:-15},onClick:()=>{e("bling",null),e("tray",null),e("vinculo",null),e("modelo",null),r("idle")},title:"Limpar todos os arquivos",className:"p-2 hover:bg-white/10 rounded-full transition-all text-red-400 hover:text-red-500",children:(0,b.jsx)(u,{className:"w-5 h-5"})}),(0,b.jsx)(x,{selectedLoja:j,setSelectedLoja:k})]}),(0,b.jsx)(n,{totalSteps:4,completedSteps:F,loading:"processing"===m}),(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 px-6",children:[{key:"bling",label:"Bling",icon:(0,b.jsx)(p.Package,{className:"w-8 h-8"})},{key:"tray",label:"Tray",icon:(0,b.jsx)(q.ShoppingCart,{className:"w-8 h-8"})},{key:"vinculo",label:"VÃ­nculo Multiloja",icon:(0,b.jsx)(s,{className:"w-8 h-8"})},{key:"modelo",label:"Modelo",icon:(0,b.jsx)(t,{className:"w-8 h-8"})}].map((c,d)=>(0,b.jsx)(l,{label:c.label,selectedFile:a[c.key],onFileSelect:a=>{a&&(z(a),D(c.key),w(!0))},stepNumber:d+1,icon:c.icon},c.key))}),"processing"!==m&&(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm",children:[(0,b.jsx)("div",{className:`w-3 h-3 rounded-full ${0===F||F<4?"bg-neutral-500":"bg-green-500"} animate-pulse`}),F<4?(0,b.jsxs)("span",{className:"text-red-500",children:[F,"/4 arquivos selecionados"]}):(0,b.jsx)("span",{className:"text-green-500 font-medium",children:"Todos os arquivos selecionados"})]}),(0,b.jsx)("div",{className:"flex justify-center items-center pt-1",children:(0,b.jsx)(d.motion.button,{whileTap:{scale:.95},onClick:G,disabled:!E||"processing"===i,className:`${(()=>{switch(m){case"processing":return"bg-orange-500 hover:bg-orange-600";case"success":return"bg-green-500 hover:bg-green-600";case"error":return"bg-red-500 hover:bg-red-600";default:return"bg-[#1A8CEB] hover:bg-[#1678c9]"}})()} px-8 h-12 text-base font-semibold shadow-md transition-all flex items-center justify-center gap-2 rounded-md ${!E||"processing"===i?"opacity-60 cursor-not-allowed":"cursor-pointer"}`,children:"processing"===m||"processing"===i?(0,b.jsx)(o.Loader,{className:"w-5 h-5 animate-spin"}):"success"===m?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.CheckCircle2,{className:"w-5 h-5"}),(0,b.jsx)("span",{children:"ConcluÃ­do!"})]}):"Iniciar"})})]})}),(0,b.jsx)(A,{open:v,onOpenChange:w,file:y,onConfirm:a=>{C&&e(C,a),w(!1),z(null),D(null)}})]})}var D=a.i(63771);function E(){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(D.LoadingBar,{}),(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen text-white"}),children:(0,b.jsx)("div",{className:"relative min-h-screen flex items-center justify-center",children:(0,b.jsx)(C,{})})})]})}a.s(["default",()=>E],74150)}];

//# sourceMappingURL=src_app_dashboard_automacoes_automacao-planilhas_page_tsx_d42bb832._.js.map